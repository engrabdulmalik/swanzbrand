import{u as v,c as k,d as I,e as g,a as d,j as r,C as x,n,T as s,_ as q,$ as B,a0 as P,F as D,ag as F,o as T}from"../../vendor.js";import{c as E,e as u,m as b,u as W,S as _}from"../../async-vendor.js";import{F as $}from"../components/FormContainer.js";import{a as N,b as w,u as L}from"../redux/actions/productActions.js";import"../../__commonjsHelpers__.js";import"../redux/constants/productConstants.js";const V=E({name:u().required("Name is required"),brand:u().required("Brand is required"),category:u().required("Category is required"),description:u().required("Description is required"),price:b().required("Price is required").positive("Price must be positive"),countInStock:b().required("Stock count is required").min(0,"Stock count cannot be negative")}),U=()=>{const f=v(),a=k(),{id:c}=I(),{loading:j,error:m,product:i}=g(t=>t.productDetails),{loading:S,error:h,categories:o=[]}=g(t=>t.categoryList),[l,y]=d.useState(null);d.useEffect(()=>{(!i.name||i._id!==Number(c))&&a(N(c))},[a,c,i._id,i.name]),d.useEffect(()=>{o.length===0&&a(w())},[a,o.length]);const e=W({initialValues:{name:"",brand:"",category:"",description:"",price:"",countInStock:""},validationSchema:V,onSubmit:t=>{const C={name:t.name,brand:t.brand,category:t.category,description:t.description,price:t.price,countInStock:t.countInStock},p=new FormData;l&&p.append("image",l,l.name),a(L(c,C,p)).then(()=>{_.fire({title:"Success!",text:`Product ${t.name} has been updated successfully`,icon:"success"}),f("/admin/product-list")})}});return d.useEffect(()=>{i.name&&o.length&&e.setValues({name:i.name||"",brand:i.brand||"",category:i.category||"",description:i.description||"",price:i.price||"",countInStock:i.countInStock||""})},[i,o]),j||S?r.jsx(x,{}):m||h?r.jsx("div",{children:m||h}):r.jsx($,{title:"Edit Product",children:r.jsx("form",{onSubmit:e.handleSubmit,children:r.jsxs(n,{container:!0,spacing:2,children:[r.jsx(n,{item:!0,xs:12,children:r.jsx(s,{fullWidth:!0,id:"name",name:"name",label:"Name",variant:"outlined",value:e.values.name,onChange:e.handleChange,error:e.touched.name&&!!e.errors.name,helperText:e.touched.name&&e.errors.name})}),r.jsx(n,{item:!0,xs:12,children:r.jsx(s,{fullWidth:!0,id:"brand",name:"brand",label:"Brand",variant:"outlined",value:e.values.brand,onChange:e.handleChange,error:e.touched.brand&&!!e.errors.brand,helperText:e.touched.brand&&e.errors.brand})}),r.jsx(n,{item:!0,xs:12,children:r.jsxs(q,{fullWidth:!0,error:e.touched.category&&!!e.errors.category,children:[r.jsx(B,{id:"category-label",children:"Category"}),r.jsx(P,{labelId:"category-label",id:"category",name:"category",value:e.values.category||"",onChange:e.handleChange,onBlur:e.handleBlur,label:"Category",children:o.map(t=>r.jsx(D,{value:t._id,children:t.name},t._id))}),r.jsx(F,{children:e.touched.category&&e.errors.category})]})}),r.jsx(n,{item:!0,xs:12,children:r.jsx(s,{fullWidth:!0,id:"description",name:"description",label:"Description",variant:"outlined",multiline:!0,rows:4,value:e.values.description,onChange:e.handleChange,error:e.touched.description&&!!e.errors.description,helperText:e.touched.description&&e.errors.description})}),r.jsx(n,{item:!0,xs:12,children:r.jsx(s,{fullWidth:!0,id:"price",name:"price",label:"Price",variant:"outlined",type:"number",value:e.values.price,onChange:e.handleChange,error:e.touched.price&&!!e.errors.price,helperText:e.touched.price&&e.errors.price})}),r.jsx(n,{item:!0,xs:12,children:r.jsx(s,{fullWidth:!0,id:"countInStock",name:"countInStock",label:"Count In Stock",variant:"outlined",type:"number",value:e.values.countInStock,onChange:e.handleChange,error:e.touched.countInStock&&!!e.errors.countInStock,helperText:e.touched.countInStock&&e.errors.countInStock})}),r.jsxs(n,{item:!0,xs:12,children:[r.jsx("input",{id:"image",name:"image",type:"file",onChange:t=>{y(t.currentTarget.files[0])}}),e.touched.image&&e.errors.image&&r.jsx("div",{children:e.errors.image})]}),r.jsx(n,{item:!0,xs:12,children:r.jsx(T,{color:"primary",variant:"contained",fullWidth:!0,type:"submit",disabled:e.isSubmitting,children:e.isSubmitting?r.jsx(x,{size:20,color:"inherit"}):"Update Product"})})]})})})};export{U as default};
