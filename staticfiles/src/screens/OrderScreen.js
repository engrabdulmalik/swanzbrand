import{d as $,c as C,e as o,a as y,j as e,C as O,A as t,l as R,n as p,P as l,f as i,L as F,a8 as v,a9 as n,aa as T,D as _,ab as c,o as B}from"../../vendor.js";import{F as M}from"../components/FormContainer.js";import{C as k}from"../components/CheckoutSteps.js";import{g as q,d as G}from"../redux/actions/orderActions.js";import{q as H,u as V}from"../redux/constants/orderContants.js";import"../../__commonjsHelpers__.js";import"../redux/constants/cartConstants.js";const Z=()=>{const{id:x}=$(),a=C(),f=o(s=>s.orderDetails),{order:r,loading:D,error:h}=f,A=o(s=>s.orderPay),{loading:Y,success:u}=A,E=o(s=>s.orderDeliver),{loading:w,success:j}=E,I=o(s=>s.userLogin),{userInfo:P}=I;y.useEffect(()=>{(!r||r._id!==Number(x)||u||j)&&(a({type:H}),a({type:V}),a(q(x)))},[a,x,r,u,j]);const d=y.useMemo(()=>{if(!r||!r.orderItems)return{itemsPrice:0,shippingPrice:0,taxPrice:0,totalPrice:0};const s=r.orderItems.reduce((S,g)=>S+g.price*g.qty,0),m=r.shippingPrice?Number(r.shippingPrice):0,L=r.totalPrice?Number(r.totalPrice):0,N=r.taxPrice?Number(r.taxPrice):0;return{itemsPrice:s.toFixed(2),shippingPrice:m.toFixed(2),totalPrice:L.toFixed(2),taxPrice:N.toFixed(2)}},[r]),b=()=>{a(G(r._id))};return D?e.jsx(O,{}):h?e.jsx(t,{severity:"error",children:h}):r?e.jsxs(M,{children:[e.jsx(k,{activeStep:5}),e.jsx(R,{children:e.jsxs(p,{container:!0,spacing:4,mt:2,children:[e.jsxs(p,{item:!0,xs:12,md:8,children:[e.jsxs(l,{sx:{p:2,mb:2},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Shipping Information"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name: "}),r.user.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email: "}),e.jsx(F,{to:`mailto:${r.user.email}`,children:r.user.email})]}),e.jsxs(i,{children:[r.shippingAddress.address,", ",r.shippingAddress.city,","," ",r.shippingAddress.postalCode,","," ",r.shippingAddress.country]}),r.isDelivered?e.jsxs(t,{severity:"success",children:["Delivered on ",r.deliveredAt]}):e.jsx(t,{severity:"error",children:"Not delivered"})]}),e.jsxs(l,{sx:{p:2,mb:2},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Payment Method"}),e.jsx(i,{children:r.paymentMethod}),r.isPaid?e.jsxs(t,{severity:"success",children:["Paid on ",r.paidAt]}):e.jsx(t,{severity:"error",children:"Not paid"})]}),e.jsxs(l,{sx:{p:2,mb:2},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Order Items"}),e.jsx(v,{children:r.orderItems.map((s,m)=>e.jsxs(n,{children:[e.jsx(T,{children:e.jsx(_,{alt:s.name,src:s.image})}),e.jsx(c,{primary:`${s.name} (x${s.qty})`,secondary:`$${Number(s.price).toFixed(2)}`})]},m))})]})]}),e.jsx(p,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:2},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Order Summary"}),e.jsxs(v,{children:[e.jsxs(n,{children:[e.jsx(c,{primary:"Items"}),e.jsxs(i,{children:["$",d.itemsPrice]})]}),e.jsxs(n,{children:[e.jsx(c,{primary:"Shipping"}),e.jsxs(i,{children:["$",d.shippingPrice]})]}),e.jsxs(n,{children:[e.jsx(c,{primary:"Tax"}),e.jsxs(i,{children:["$",d.taxPrice]})]}),e.jsxs(n,{children:[e.jsx(c,{primary:"Total"}),e.jsxs(i,{children:["$",d.totalPrice]})]})]}),P&&P.isAdmin&&!r.isDelivered&&(r.isPaid||r.paymentMethod==="cashOnDelivery")&&e.jsx(B,{variant:"contained",color:"primary",onClick:b,sx:{mt:2},children:"Mark As Delivered"})]})})]})})]}):e.jsx(t,{severity:"info",children:"No order found"})};export{Z as default};
